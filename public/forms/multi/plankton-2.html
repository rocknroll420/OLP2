<h2>Plankton Tow 2</h2>
<h3 id="section-title"></h3>
<form id="plankton-2" name="plankton-2" action="form/?form=planktonObs" method="post" enctype="multipart/form-data" target="iframe">
	<h3>Plankton Tow Survey - Observations</h3>
	Date: <date></date>
	<br><br>
	
	<formline>
		<label for="towID">Plankton Tow ID Number: </label><input id="towID" type="number" name="towID" required />
		<p>if the Plankton Tow ID Number is BLANK or NOT CORRECT you must ENTER THE CORRECT NUMBER now.</p>
	</formline>
	
	<formline>
		<label for="recorder_name">Data Recorder's Name: </label><input id="recorder_name" name="recorder_name" type="text" autocomplete="off" required />
	</formline>
	
	<formline>
		<label for="mesh_size">Net Mesh Size (micrometres): </label>
		<select id="mesh_size" name="mesh_size" value="" required>
			<option value="60">60</option>
			<option value="333">333</option>
			<option SELECTED value=""></option>
		</select>
	</formline>
	
	<formline>
		<label for="survey_depth">Average Depth of Survey (m): </label><input id="survey_depth" name="survey_depth" type="number" min="0" special="pos" required/>
	</formline>

	
	<u>Plankton Species Observed:</u><br>
	check all species that you observed
	<div id="plankton_names">
	</div>


	<formline>
		<label for="comment" type="textarea">Add Comments if required (optional):<br></label>
		<textarea id="comment" name="comment" rows="3" cols="37" ></textarea>
	</formline>
	
	<formline>
		<button id="review">Review Data</button>
	</formline>
</form>
<script>
	$(document).ready(function(){
		//var hash = window.location.hash.split('/');
		var getNames = function(retry){
			$.get('select/?s=get_plankton_names', function(data){
				data = JSON.parse(data);
				if(data.error){
					if(retry < 5){
						console.log("select request failed... requesting again");
						getNames(++retry);
						return;
					}
					console.log("plankton_names requests reached maximum retries");
					return;
				}
				else if(!data.success){
					if(retry < 5){
						console.log("no response from server... requesting again");
						getNames(++retry);
						return;
					}
					console.log("server busy try again later");
					return;
				}
				else{
					for(var x in data.success){
						$('#plankton_names').append($('<formline class="checkboxline" />').html("<input id='"+data.success[x].code+"' name='"+data.success[x].code+"' value='"+data.success[x].name+"' type='checkbox'/><label for='"+data.success[x].code+"' type='checkbox'>"+data.success[x].name+"</label>"));
					}
				}
				
				console.log(data);
				
			});
		};
		getNames(0);
	});
</script>